
class Platform:

    class _Platform:

        def __init__(self, arch):

            self.type = arch

            if arch == "x86_64":
                
                self.SUPPORTED_REGS = ["rax", "rbx", "rcx", "rdx", "rsi", "rdi", "rbp",
                                        "r8", "r9", "r10", "r11", "r12", "r13", "r14", "r15"]

                self.IGNORED_INSTR_MNEMONICS = ["endbr64", "clc", "cld", "cldemote", "clflush", "clflushopt", 
                                                "cli", "clts", "clwb", "cmc", "fnop", "vzeroupper", "nop"]

                self.ENDPOINTS = { b'\xc3': "ret", b'\xff\xe0': "jmp rax", b'\xff\xe3': "jmp rbx", b'\xff\xe1': "jmp rcx", 
                    b'\xff\xe2': "jmp rdx", b'\xff\xe5': "jmp rbp", b'\xff\xe6': "jmp rsi", b'\xff\xe7': "jmp rdi", 
                    b'\x41\xff\xe0': "jmp r8", b'\x41\xff\xe1': "jmp r9", b'\x41\xff\xe2': "jmp r10", b'\x41\xff\xe3': "jmp r11", 
                    b'\x41\xff\xe4': "jmp r12", b'\x41\xff\xe5': "jmp r13", b'\x41\xff\xe6': "jmp r14", b'\x41\xff\xe7': "jmp r15" }

                self.RET_OPCODE = b'\xc3'

            elif arch == "arm64":

                self.SUPPORTED_REGS = []
                self.IGNORED_INSTR_MNEMONICS = []

                self.ENDPOINTS = {}

                self.RET_OPCODE = b''

            else:
                raise RuntimeError(f"Unsupported platform {arch}")

    X86_64 = _Platform("x86_64")
    ARM64 = _Platform("arm64")
