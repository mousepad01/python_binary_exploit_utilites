from struct import pack, unpack

to_bytes = lambda x: pack("Q", x)
from_bytes = lambda x: unpack("Q", x)[0]

# also checks for newline
def check_whitespaces(payload):

    whitespaces = [b'\x09', b'\x0a', b'\x0b', b'\x0c', b'\x0d', b'\x20', b'\x85', b'\xa0', b'\n']
    for c in whitespaces:
        if c in payload:
            raise RuntimeError(f"Whitespace character {c} detected in payload; terminating\n")